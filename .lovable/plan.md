
# ุฎุทุฉ ุชุญุณูู ุดุงููุฉ ูููุธุงู

## ุชูุฑูุฑ ุชุญูููู ูููุถุน ุงูุญุงูู

### 1. ูุดุงูู ููุญุฉ ุงูุชุญูู (Dashboard)
- **ุฅุญุตุงุฆูุงุช ุบูุฑ ูุชูุงููุฉ**: ููุญุฉ ุงูุชุญูู ุชุณุชุฎุฏู `totalServers` ู `activeServers` ูู ุฌุฏูู `resources` ุญูุซ `resource_type = 'physical_server'`ุ ููููุง ูุง ุชุนูุณ ูุธุงู ุงูููุงุฑุฏ ุงูุฌุฏูุฏ (Resources) ุจุดูู ูุงูู
- **ูุตูุต ุซุงุจุชุฉ ุบูุฑ ูุชุฑุฌูุฉ**: ููุฌุฏ ูุตูุต ุนุฑุจูุฉ ุซุงุจุชุฉ ูุซู "ูุฑุญุจุงูุ ูุฏูุฑ ุงููุธุงู"ุ "ูุณุจุฉ ุฅูุฌุงุฒ ุงูููุงู"ุ "ููุฏ ุงูุชูููุฐ" ุบูุฑ ูุชุฑุฌูุฉ ููุฅูุฌููุฒูุฉ
- **ุนุฏู ุฑุจุท ูุน Datacenter**: ูุง ููุฌุฏ ุฅุญุตุงุฆูุงุช ูู ูุธุงู ูุฑุงูุฒ ุงูุจูุงูุงุช (Clusters, Nodes, VMs)

### 2. ุชูุฑุงุฑ ุตูุญุงุช ุงููุฎุฒูู
- **ุตูุญุฉ Servers**: `/servers` - ูุธุงู ูุฏูู ูุนุชูุฏ ุนูู `server_inventory_view`
- **ุตูุญุฉ Resources**: `/resources` - ูุธุงู ุฌุฏูุฏ ููุญุฏ ูุฏุนู VMs, Physical Servers, Appliances, Services, etc.
- **ุงูุชูุฑุงุฑ ูุณุจุจ ุงุฑุชุจุงู** ูุนุฏู ุงุชุณุงู ูู ุงูุจูุงูุงุช

### 3. ูุฌูุฉ ุงูุฑุจุท ุจูู Datacenter ู Resources
- **ุฌุฏูู `resources`**: ูุญุชูู ุนูู `site_id`, `domain_id` ููู ูุง ูุฑุชุจุท ุจู Clusters/Nodes
- **ุฌุฏูู `vms` (Datacenter)**: ูุญุชูู ุนูู `cluster_id`, `host_node_id` ูููู ูููุตู
- **ูุง ููุฌุฏ ุชูุงูู** ุจูู ุงููุธุงููู ุญุงููุงู

### 4. ูุดุงูู ุงูุชุฑุฌูุฉ
- **ููุญุฉ ุงูุชุญูู**: 8+ ูุตูุต ุนุฑุจูุฉ ุซุงุจุชุฉ ุจุฏูู ููุงุชูุญ ุชุฑุฌูุฉ
- **ุตูุญุฉ Tasks**: ูุตูุต ูุซู "ูุง ุชูุฌุฏ ููุงู ููุฏ ุงูุชูููุฐ!" ุบูุฑ ูุชุฑุฌูุฉ
- **ุตูุญุฉ Employees**: ูุต "ููุฏ ุงูุชูููุฐ" ุซุงุจุช

---

## ุงููุฑุญูุฉ 1: ุฅุตูุงุญ ุงูุชุฑุฌูุงุช (ุฃููููุฉ ุนุงููุฉ)

### ุงูุฅุฌุฑุงุกุงุช:
1. **ุฅุถุงูุฉ ููุงุชูุญ ุชุฑุฌูุฉ ุฌุฏูุฏุฉ** ูู `LanguageContext.tsx`:
   - `dashboard.welcome.admin` โ "ูุฑุญุจุงูุ ูุฏูุฑ ุงููุธุงู" / "Welcome, Admin"
   - `dashboard.welcome.user` โ "ูุฑุญุจุงูุ {name}" / "Welcome, {name}"
   - `dashboard.taskProgress` โ "ูุณุจุฉ ุฅูุฌุงุฒ ุงูููุงู" / "Task Completion"
   - `dashboard.inProgress` โ "ููุฏ ุงูุชูููุฐ" / "In Progress"
   - `dashboard.total` โ "ุงูุฅุฌูุงูู" / "Total"

2. **ุชุญุฏูุซ Dashboard.tsx** ูุงุณุชุฎุฏุงู ููุงุชูุญ ุงูุชุฑุฌูุฉ ุจุฏูุงู ูู ุงููุตูุต ุงูุซุงุจุชุฉ

3. **ุฅุตูุงุญ ุตูุญุงุช ุฃุฎุฑู** (Tasks.tsx, Employees.tsx) ูุงุณุชุฎุฏุงู ุงูุชุฑุฌูุงุช

---

## ุงููุฑุญูุฉ 2: ุชุญุฏูุซ ููุญุฉ ุงูุชุญูู

### ุงูุชุบููุฑุงุช ุงููุทููุจุฉ ูู `Dashboard.tsx`:

```text
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ููุญุฉ ุงูุชุญูู ุงููุญุฏูุซุฉ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ ุฅุญุตุงุฆูุงุช ุฌุฏูุฏุฉ (6 ุจุทุงูุงุช):                                 โ
โ  โโโโโโโโโโโฌโโโโโโโโโโโโฌโโโโโโโโโโโโฌโโโโโโโโโโโโโฌโโโโโโโฌโโโโโโโ โ
โ  โุงูููุงุฑุฏ  โ VMs      โPhysical  โ ุชุฑุงุฎูุต    โููุงู  โููุธูููโ โ
โ  โุงููููุฉ  โ          โServers   โ ููุชููุฉ    โูุนููุฉ โ      โ โ
โ  โโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโดโโโโโโโ โ
โ                                                                 โ
โ  ๐ ูุฏุฌุช ุงูุจููุฉ ุงูุชุญุชูุฉ (ุฌุฏูุฏ):                                โ
โ  - ุนุฏุฏ Clusters                                                โ
โ  - ุนุฏุฏ Nodes                                                   โ
โ  - ุงุณุชุฎุฏุงู CPU/RAM/Storage                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุชุญุฏูุซ `useDashboardStats`:
- ุงุณุชุจุฏุงู `totalServers` ุจู `totalResources` (ุฌููุน ุงูููุงุฑุฏ)
- ุฅุถุงูุฉ `totalVMs` ู `totalPhysicalServers` ูุฅุญุตุงุฆูุงุช ูููุตูุฉ
- ุฅุถุงูุฉ `activResources` ุจุฏูุงู ูู `activeServers`
- ุฏูุฌ ุฅุญุตุงุฆูุงุช ูู `useDatacenterStats` (Clusters, Nodes, VMs)

---

## ุงููุฑุญูุฉ 3: ุญุฐู ุตูุญุฉ Servers

### ุงูุฅุฌุฑุงุกุงุช:
1. **ุญุฐู ุงููููุงุช**:
   - `src/pages/Servers.tsx`

2. **ุชุญุฏูุซ App.tsx**:
   - ุฅุฒุงูุฉ ุงุณุชูุฑุงุฏ `Servers`
   - ุฅุฒุงูุฉ Route `/servers`
   - ุฅุถุงูุฉ Redirect ูู `/servers` ุฅูู `/resources`

3. **ุชุญุฏูุซ Sidebar.tsx**:
   - ุฅุฒุงูุฉ ุนูุตุฑ "servers" ูู ูุงุฆูุฉ `menuGroups.inventory`

4. **ุชุญุฏูุซ ุงููุฑุงุฌุน ุงูุฃุฎุฑู**:
   - `QuickActions.tsx`: ุชุบููุฑ "ุฅุถุงูุฉ ุณูุฑูุฑ" ููุงูุชูุงู ุฅูู `/resources`

---

## ุงููุฑุญูุฉ 4: ุฑุจุท Datacenter ูุน Resources

### ุงูุงุณุชุฑุงุชูุฌูุฉ: "ุงูุนูุงูุฉ ุงูุงุฎุชูุงุฑูุฉ"
```text
resources (ุงูุฌุฏูู ุงูุฑุฆูุณู)
    โ
    โโโ site_id (ุฅูุฒุงูู)
    โโโ domain_id (ุงุฎุชูุงุฑู)
    โ
    โโโ cluster_id (ุฌุฏูุฏ - ุงุฎุชูุงุฑู) โโโโโบ clusters
    โโโ host_node_id (ุฌุฏูุฏ - ุงุฎุชูุงุฑู) โโโบ cluster_nodes
```

### ุงูุชูููุฐ:
1. **ุฅุถุงูุฉ ุฃุนูุฏุฉ ููุฌุฏูู resources**:
   ```sql
   ALTER TABLE public.resources
     ADD COLUMN cluster_id UUID REFERENCES public.clusters(id) ON DELETE SET NULL,
     ADD COLUMN host_node_id UUID REFERENCES public.cluster_nodes(id) ON DELETE SET NULL;
   ```

2. **ุชุญุฏูุซ ูููุฐุฌ ุฅูุดุงุก Resource**:
   - ุฅุถุงูุฉ ุฎูุงุฑ ุงุฎุชูุงุฑ Cluster ู Node ููู VMs
   - ุนุฑุถ dropdown ููููุณุชุฑุงุช ุงููุชุงุญุฉ ุจูุงุกู ุนูู ุงููููุน/ุงููุทุงู

3. **ุชุญุฏูุซ ุตูุญุฉ Datacenter**:
   - ูู ุชุจููุจ "ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ" ุนุฑุถ ุงูู VMs ูู `resources` ุงููุฑุชุจุทุฉ ุจุงูููุณุชุฑ
   - ุฅุถุงูุฉ ุฎูุงุฑ "ุฑุจุท VM ููุฌูุฏ" ุจุฏูุงู ูู ุฅูุดุงุก ุฌุฏูุฏ

4. **ุฅุฒุงูุฉ ุงูุงุฒุฏูุงุฌูุฉ**:
   - ุฌุฏูู `vms` ูุตุจุญ ูููุฑุงุกุฉ ููุท (Legacy) ุฃู ููุญุฐู ูุงุญูุงู
   - ุฌููุน ุงูุนูููุงุช ุชุชู ุนูู `resources` ูุน `resource_type = 'vm'`

---

## ุงููุฑุญูุฉ 5: ุชุญุณูู ุงูุฃุฏุงุก ูุงูุงุณุชูุฑุงุฑ

### ุงูุฅุฌุฑุงุกุงุช:
1. **ูุฑุงุฌุนุฉ React Query settings**:
   - ุงูุชุฃูุฏ ูู `staleTime: 30s` ูุฌููุน ุงูุงุณุชุนูุงูุงุช
   - ุฅุถุงูุฉ `refetchOnWindowFocus: false` globallly (โ ููุฌูุฏ)

2. **ุชุญุณูู Dashboard Stats**:
   - ุฅูุดุงุก RPC `get_dashboard_summary` ูุชุฌููุน ุงูุฅุญุตุงุฆูุงุช ูู ุงุณุชุนูุงู ูุงุญุฏ
   - ุชูููู ุนุฏุฏ ุงูุทูุจุงุช ุงููุชูุงุฒูุฉ

3. **Cache Isolation**:
   - ุงูุชุฃูุฏ ูู ุฃู ุฌููุน `queryKeys` ุชุชุถูู `siteId`

---

## ููุฎุต ุงูุชุบููุฑุงุช ุงููุทููุจุฉ

| ุงูููู | ููุน ุงูุชุบููุฑ | ุงูุฃููููุฉ |
|-------|-------------|----------|
| `src/contexts/LanguageContext.tsx` | ุฅุถุงูุฉ 15+ ููุชุงุญ ุชุฑุฌูุฉ | ุนุงููุฉ |
| `src/pages/Dashboard.tsx` | ุฅุนุงุฏุฉ ุจูุงุก + ุงุณุชุฎุฏุงู ุชุฑุฌูุงุช | ุนุงููุฉ |
| `src/hooks/useSupabaseData.ts` | ุชุญุฏูุซ `useDashboardStats` | ุนุงููุฉ |
| `src/pages/Servers.tsx` | ุญุฐู | ูุชูุณุทุฉ |
| `src/App.tsx` | ุฅุฒุงูุฉ Route + ุฅุถุงูุฉ Redirect | ูุชูุณุทุฉ |
| `src/components/layout/Sidebar.tsx` | ุฅุฒุงูุฉ ุฑุงุจุท Servers | ูุชูุณุทุฉ |
| `migration.sql` | ุฅุถุงูุฉ cluster_id, host_node_id | ูุชูุณุทุฉ |
| `src/types/resources.ts` | ุชุญุฏูุซ Types | ูุชูุณุทุฉ |
| `src/pages/Resources.tsx` | ุฅุถุงูุฉ Cluster/Node selector | ูุชูุณุทุฉ |
| `src/components/datacenter/VMTable.tsx` | ุฑุจุท ูุน resources | ูุชูุณุทุฉ |

---

## ุงูุฌุฏูู ุงูุฒููู ุงูููุชุฑุญ

```text
ุงููุฑุญูุฉ 1: ุงูุชุฑุฌูุงุช โโโโโโโโโโโโโโบ โ ููุชููุฉ
ุงููุฑุญูุฉ 2: ููุญุฉ ุงูุชุญูู โโโโโโโโโโโบ โ ููุชููุฉ
ุงููุฑุญูุฉ 3: ุญุฐู Servers โโโโโโโโโโโบ โ ููุชููุฉ
ุงููุฑุญูุฉ 4: ุฑุจุท Datacenter โโโโโโโโบ (ุจุนุฏ ุงุณุชูุฑุงุฑ ุงููุฑุงุญู ุงูุณุงุจูุฉ)
ุงููุฑุญูุฉ 5: ุชุญุณูู ุงูุฃุฏุงุก โโโโโโโโโโบ (ูุณุชูุฑ)
```

---

## ููุงุญุธุงุช ูููุฉ ูุงูุฉ

1. **ูุง ุญุงุฌุฉ ูู Data Migration**: ุฌุฏูู `resources` ููุฌูุฏ ููุนููุ ููุท ูุถูู ุฃุนูุฏุฉ ุฌุฏูุฏุฉ
2. **ุงูุชูุงูู ุงูุนูุณู**: ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ ุงุฎุชูุงุฑูุฉ (nullable)
3. **ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุญุฐูุฑ**: ุนูุฏ ุงูุงูุชูุงู ูู `/servers` ุณูุชู ุชูุฌูู ุงููุณุชุฎุฏู ูู `/resources`

## ููุฎุต ุงูุชูููุฐ

### โ ุงููุฑุญูุฉ 1-3 ููุชููุฉ:
- ุฅุถุงูุฉ 15+ ููุชุงุญ ุชุฑุฌูุฉ ุฌุฏูุฏ (AR/EN)
- ุชุญุฏูุซ Dashboard ูุนุฑุถ Resources, VMs, Physical Servers, Clusters, Nodes
- ุญุฐู ุตูุญุฉ Servers.tsx
- ุฅุถุงูุฉ ุชูุฌูู `/servers` โ `/resources`
- ุฅุฒุงูุฉ Servers ูู Sidebar
- ุชุญุฏูุซ QuickActions ููุงูุชูุงู ุฅูู Resources

